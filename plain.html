<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RO MVP Macro Data</title>
    <style>
        body {
            background-color: #000000; /* ‡∏î‡∏≥‡∏™‡∏ô‡∏¥‡∏ó */
            color: #ffffff;
            font-family: "Courier New", monospace; /* ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏û‡∏¥‡∏°‡∏û‡πå‡∏î‡∏µ‡∏î ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏≠‡∏ó */
            font-size: 16px;
            margin: 20px;
            white-space: nowrap; /* ‡∏´‡πâ‡∏≤‡∏°‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà */
        }

        table {
            border-collapse: collapse;
            width: 100%;
            max-width: 800px; /* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ */
        }

        td {
            padding: 2px 5px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
            vertical-align: top;
        }

        /* ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏≠‡∏™ */
        .col-name {
            width: 30%; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ */
            min-width: 250px;
            text-align: left;
        }

        /* ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ : */
        .col-sep {
            width: 20px;
            text-align: center;
        }

        /* ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ */
        .col-status {
            width: auto;
            text-align: left;
        }
        
        /* CSS Classes ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏µ */
        .name-white { color: #ffffff; }
        .name-green { color: #00ff00; }
        
        .status-dead { color: #ff0000; }   /* ‡∏™‡∏µ‡πÅ‡∏î‡∏á */
        .status-window { color: #ffffff; } /* ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
        .status-alive { color: #00ff00; }  /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
    </style>
</head>
<body>

    <div id="data-container">Loading...</div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // ============================================================
        // üî¥ Config ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì üî¥
        // ============================================================
        const firebaseConfig = {
            apiKey: "AIzaSyBG-s9H6mYhElU4jQutXOIq0VGZ5G7EEPA",
            authDomain: "custom-ro-auto-boss-timing.firebaseapp.com",
            databaseURL: "https://custom-ro-auto-boss-timing-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "custom-ro-auto-boss-timing",
            storageBucket: "custom-ro-auto-boss-timing.firebasestorage.app",
            messagingSenderId: "963784417984",
            appId: "1:963784417984:web:bd15cc38064248f50f4325"
        };

        // ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏≠‡∏™‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î
        const mvpList = [
            { id: 'amon_ra', name: 'Amon Ra' },
            { id: 'eremes', name: 'Assassin Cross Eremes' },
            { id: 'bacsojin', name: 'Bacsojin' },
            { id: 'baphomet', name: 'Baphomet' },
            { id: 'boitata', name: 'Boitata' },
            { id: 'dark_lord', name: 'Dark Lord' },
            { id: 'detale', name: 'Detale' },
            { id: 'doppel', name: 'Doppelganger' },
            { id: 'dracula', name: 'Dracula' },
            { id: 'drake', name: 'Drake' },
            { id: 'eddga', name: 'Eddga' },
            { id: 'evil_snake_lord', name: 'Evil Snake Lord' },
            { id: 'bishop', name: 'Fallen Bishop' },
            { id: 'hatii', name: 'Garm / Hatii' },
            { id: 'gloom', name: 'Gloom Under Night' },
            { id: 'gold_queen', name: 'Gold Queen Scaraba' },
            { id: 'gtb', name: 'Golden Thief Bug' },
            { id: 'gopinich', name: 'Gopinich' },
            { id: 'magaleta', name: 'High Priest Magaleta' },
            { id: 'katrinn', name: 'High Wizard Katrinn' },
            { id: 'ifrit', name: 'Ifrit' },
            { id: 'samurai', name: 'Incantation Samurai' },
            { id: 'kiel', name: 'Kiel D-01' },
            { id: 'stormy', name: 'Stormy Knight' },
            { id: 'lady_tanee', name: 'Lady Tanee' },
            { id: 'leak', name: 'Leak' },
            { id: 'seyren', name: 'Lord Knight Seyren' },
            { id: 'lord_of_death', name: 'Lord of Death' },
            { id: 'maya', name: 'Maya' },
            { id: 'mistress', name: 'Mistress' },
            { id: 'moonlight', name: 'Moonlight Flower' },
            { id: 'orc_lord', name: 'Orc Lord' },
            { id: 'osiris', name: 'Osiris' },
            { id: 'pharaoh', name: 'Pharaoh' },
            { id: 'phreeoni', name: 'Phreeoni' },
            { id: 'queen_scaraba', name: 'Queen Scaraba' },
            { id: 'rsx', name: 'RSX 0806' },
            { id: 'shecil', name: 'Sniper Shecil' },
            { id: 'tao_gunka', name: 'Tao Gunka' },
            { id: 'turtle_general', name: 'Turtle General' },
            { id: 'valkyrie', name: 'Valkyrie Randgris' },
            { id: 'vesper', name: 'Vesper' },
            { id: 'harword', name: 'Whitesmith Harword' },
            { id: 'morocc', name: 'Wounded Morocc' },
            { id: 'ygnizem', name: 'Ygnizem' },
            // ‡∏ö‡∏≠‡∏™‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏°‡∏û
            { id: 'atroce_ra_fild02', name: 'Atroce (ra_fild02)' },
            { id: 'atroce_ra_fild03', name: 'Atroce (ra_fild03)' },
            { id: 'atroce_ra_fild04', name: 'Atroce (ra_fild04)' },
            { id: 'atroce_ve_fild01', name: 'Atroce (ve_fild01)' },
            { id: 'atroce_ve_fild02', name: 'Atroce (ve_fild02)' },
            { id: 'orc_hero_gef_fild02', name: 'Orc Hero (gef_fild02)' },
            { id: 'orc_hero_gef_fild14', name: 'Orc Hero (gef_fild14)' },
            // ‡∏ö‡∏≠‡∏™‡πÉ‡∏´‡∏°‡πà
            { id: 'beelzebub', name: 'Beelzebub' }
        ];

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const mvpRef = db.ref('mvp');
        const container = document.getElementById('data-container');
        
        let currentData = {};

        mvpRef.on('value', snapshot => {
            currentData = snapshot.val() || {};
            renderTextMode();
        });

        setInterval(() => { 
            if(Object.keys(currentData).length > 0) renderTextMode(); 
        }, 1000);

        function renderTextMode() {
            const now = new Date().getTime();
            const LATE_MS = 600000; // 10 ‡∏ô‡∏≤‡∏ó‡∏µ

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (A-Z)
            const sortedList = [...mvpList].sort((a, b) => a.name.localeCompare(b.name));

            let tableHtml = '<table>';

            sortedList.forEach(boss => {
                const info = currentData[boss.id];
                
                let nameClass = "name-white";
                let statusHtml = "";
                
                if (info && info.respawnAt) {
                    const diff = info.respawnAt - now;
                    const seconds = Math.floor(Math.abs(diff) / 1000); // ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°

                    if (diff > 0) {
                        // 1. ‡∏ï‡∏≤‡∏¢ (Cooldown) -> ‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≤‡∏ß : ‡πÅ‡∏î‡∏á
                        nameClass = "name-white";
                        statusHtml = `<span class="status-dead">dead. Respawn in ${seconds} seconds.</span>`;
                    } 
                    else if (diff > -LATE_MS) {
                        // 2. ‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏∏‡πà‡∏° 10 ‡∏ô‡∏≤‡∏ó‡∏µ (Window) -> ‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≤‡∏ß : ‡∏Ç‡∏≤‡∏ß (‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á)
                        const windowLeftSeconds = Math.floor((LATE_MS + diff) / 1000);
                        nameClass = "name-white";
                        statusHtml = `<span class="status-window">${windowLeftSeconds}</span>`;
                    } 
                    else {
                        // 3. ‡πÄ‡∏Å‡∏¥‡∏î‡∏ä‡∏±‡∏ß‡∏£‡πå (Alive) -> ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß : ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                        nameClass = "name-green";
                        statusHtml = `<span class="status-alive">Alive</span>`;
                    }
                } else {
                    // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (N/A)
                    nameClass = "name-white";
                    statusHtml = `<span class="name-white">N/A</span>`;
                }

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
                tableHtml += `
                    <tr id="row-${boss.id}">
                        <td class="col-name ${nameClass}">${boss.name}</td>
                        <td class="col-sep">:</td>
                        <td class="col-status">${statusHtml}</td>
                    </tr>
                `;
            });

            tableHtml += '</table>';
            container.innerHTML = tableHtml;
        }
    </script>
</body>
</html>